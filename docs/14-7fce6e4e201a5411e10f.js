(window.webpackJsonp=window.webpackJsonp||[]).push([[14,17],{26:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__.d(__webpack_exports__,"RecordData",(function(){return RecordData})),__webpack_require__.d(__webpack_exports__,"RecordInfo",(function(){return RecordInfo})),__webpack_require__.d(__webpack_exports__,"recordListReducer",(function(){return recordListReducer}));var _workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),_util_canvas__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(56),enterModule;function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,r){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var t=[],n=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(t.push(c.value),!r||t.length!==r);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return t}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,r,t,n,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void t(e)}i.done?r(s):Promise.resolve(s).then(n,a)}function _asyncToGenerator(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var o=e.apply(r,t);function c(e){asyncGeneratorStep(o,n,a,c,i,"next",e)}function i(e){asyncGeneratorStep(o,n,a,c,i,"throw",e)}c(void 0)}))}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},RecordData=function(){function RecordData(){_classCallCheck(this,RecordData),this.add=void 0,this.remove=void 0,this.modify=void 0}return _createClass(RecordData,[{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),RecordData}(),deleteRecordFile=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(r){var t,n,a,o,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r.type,n=r.data,e.t0=t,e.next="add"===e.t0?4:"modify"===e.t0?8:"remove"===e.t0?12:16;break;case 4:return n=n,e.next=7,_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.remove(n.canvasPath,{isFile:!0});case 7:return e.abrupt("break",16);case 8:return o=(a=n).fromCanvasPath,c=a.toCanvasPath,e.next=11,Promise.all([_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.remove(o,{isFile:!0}),_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.remove(c,{isFile:!0})]);case 11:return e.abrupt("break",16);case 12:return i=n.canvasPath,e.next=15,_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.remove(i,{isFile:!0});case 15:return e.abrupt("break",16);case 16:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),RecordInfo=function(){function RecordInfo(e,r){_classCallCheck(this,RecordInfo),this.type=e,this.data=r}return _createClass(RecordInfo,[{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),RecordInfo}(),getRevertRecor=function(e){var r=e.type,t=e.data;if("add"===r){var n=t,a=n.index,o=n.canvasPath;return new RecordInfo("remove",{index:a,canvasPath:o})}if("modify"===r){var c=t,i=c.index,s=c.fromCanvasPath,u=c.toCanvasPath;return new RecordInfo("modify",{index:i,fromCanvasPath:u,toCanvasPath:s})}var d=t,l=d.index,_=d.canvasPath;return new RecordInfo("add",{index:l,canvasPath:_})},handleOperate=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(r,t){var n,a,o,c,i,s,u,d,l,_,f,v,p,y,b,h,m,R,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.type,a=r.data,console.log("handleOperate: ",n),"add"!==n){e.next=15;break}return c=(o=a).index,i=o.canvasPath,e.next=6,_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.get(i,{isDir:!1});case 6:return s=e.sent,u=_slicedToArray(s,1),d=u[0],e.next=11,Object(_util_canvas__WEBPACK_IMPORTED_MODULE_1__.c)(d);case 11:return l=e.sent,_=t.addLayerContent(c,l,"history"),t.focusLayer(_),e.abrupt("return");case 15:if("modify"!==n){e.next=28;break}return v=(f=a).index,f.fromCanvasPath,p=f.toCanvasPath,e.next=19,_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.get(p,{isDir:!1});case 19:return y=e.sent,b=_slicedToArray(y,1),h=b[0],e.next=24,Object(_util_canvas__WEBPACK_IMPORTED_MODULE_1__.c)(h);case 24:return m=e.sent,R=t.setLayerContent(v,m,"history"),t.focusLayer(R),e.abrupt("return");case 28:if("remove"!==n){e.next=32;break}return g=a.index,t.removeLayerByIndex(g,"history"),e.abrupt("return");case 32:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),MAX_ROCORD_NUMBER=100,recordListReducer=function(e,r){var t=e.cursor,n=e.recorderList,a=r.type,o=r.payload,c=r.pCanvasController;switch(a){case"add":if(t<n.length-1)n.splice(Math.max(t,0)).map((function(e){return deleteRecordFile(e)}));if(MAX_ROCORD_NUMBER<=n.length)n.splice(0,n.length-MAX_ROCORD_NUMBER+1).map((function(e){return deleteRecordFile(e)}));t++,o&&n.push(o);break;case"redo":if(++t<=n.length-1){var i=n[t];c&&handleOperate(i,c)}break;case"undo":if(t>-1){var s=n[t];c&&handleOperate(getRevertRecor(s),c)}t--}return{cursor:Math.max(Math.min(t,n.length-1),-1),recorderList:n}},reactHotLoader,leaveModule;reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&(reactHotLoader.register(RecordData,"RecordData","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/reducer.ts"),reactHotLoader.register(deleteRecordFile,"deleteRecordFile","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/reducer.ts"),reactHotLoader.register(RecordInfo,"RecordInfo","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/reducer.ts"),reactHotLoader.register(getRevertRecor,"getRevertRecor","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/reducer.ts"),reactHotLoader.register(handleOperate,"handleOperate","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/reducer.ts"),reactHotLoader.register(MAX_ROCORD_NUMBER,"MAX_ROCORD_NUMBER","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/reducer.ts"),reactHotLoader.register(recordListReducer,"recordListReducer","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/reducer.ts")),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)}.call(this,__webpack_require__(3)(module))},46:function(e,r,t){var n=t(47),a="object"==typeof self&&self&&self.Object===Object&&self,o=n||a||Function("return this")();e.exports=o},47:function(e,r,t){(function(r){var t="object"==typeof r&&r&&r.Object===Object&&r;e.exports=t}).call(this,t(48))},48:function(e,r){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},49:function(e,r){e.exports=function(){return!1}},50:function(e,r){var t=Array.isArray;e.exports=t},51:function(e,r,t){var n=t(52),a=0;e.exports=function(e){var r=++a;return n(e)+r}},52:function(e,r,t){var n=t(53);e.exports=function(e){return null==e?"":n(e)}},53:function(e,r,t){var n=t(54),a=t(55),o=t(50),c=t(49),i=n?n.prototype:void 0,s=i?i.toString:void 0;e.exports=function e(r){if("string"==typeof r)return r;if(o(r))return a(r,e)+"";if(c(r))return s?s.call(r):"";var t=r+"";return"0"==t&&1/r==-1/0?"-0":t}},54:function(e,r,t){var n=t(46).Symbol;e.exports=n},55:function(e,r){e.exports=function(e,r){for(var t=-1,n=null==e?0:e.length,a=Array(n);++t<n;)a[t]=r(e[t],t,e);return a}},56:function(e,r,t){"use strict";(function(e){t.d(r,"b",(function(){return s})),t.d(r,"a",(function(){return u})),t.d(r,"c",(function(){return d})),t.d(r,"d",(function(){return l}));var n,a=t(51),o=t.n(a);(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var c,i,s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0,n=document.createElement("canvas");n.width=e,n.height=r,n.setAttribute("uuid",o()("canvasId-"));var a=n.getContext("2d");return a&&t&&(a.fillStyle=t.toRGBAString(),a.fillRect(0,0,e,r)),n},u=function(e){var r=document.createElement("canvas");r.width=e.width,r.height=e.height;var t=r.getContext("2d");return null==t||t.clearRect(0,0,r.width,r.height),null==t||t.drawImage(e,0,0,e.width,e.height),r},d=function(e){return new Promise((function(r){var t=new Image;t.onload=function(){t.onload=null,r(u(t))},t.src=URL.createObjectURL(e)}))},l=function(e){return new Promise((function(r){e.toBlob(r,"image/png",1)}))};(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(c.register(s,"createCanvas","/Users/muyin/Documents/code/WebPencil/src/util/canvas.ts"),c.register(u,"copyCanvas","/Users/muyin/Documents/code/WebPencil/src/util/canvas.ts"),c.register(d,"createCanvasByFile","/Users/muyin/Documents/code/WebPencil/src/util/canvas.ts"),c.register(l,"toBlob","/Users/muyin/Documents/code/WebPencil/src/util/canvas.ts")),(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&i(e)}).call(this,t(3)(e))}}]);