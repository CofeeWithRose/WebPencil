(window.webpackJsonp=window.webpackJsonp||[]).push([[4,7,14,17,24,25],[,,,,,function(e,t,r){"use strict";r.r(t),function(e){var n,a=r(51),o=r.n(a),c=r(0),i=r.n(c),d=r(1),u=r(37),s=r.n(u),l=r(56),f=r(26),_=r(14);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],n=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(e,t,r,n,a,o,c){try{var i=e[o](c),d=i.value}catch(e){return void r(e)}i.done?t(d):Promise.resolve(d).then(n,a)}function b(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function c(e){v(o,n,a,c,i,"next",e)}function i(e){v(o,n,a,c,i,"throw",e)}c(void 0)}))}}(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);var y,h,m="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},g=function(){var e=b(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="record_".concat(Date.now(),"_").concat(o()(),".png"),e.next=3,Object(l.d)(t);case 3:if(n=e.sent,a="record/".concat(r),!n){e.next=8;break}return e.next=8,_.a.save({type:"blob",data:n,path:a});case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(e){var t=e.pCanvasController,r=p(Object(c.useReducer)(f.recordListReducer,{cursor:-1,recorderList:[]}),2),n=r[0],a=n.cursor,o=n.recorderList,u=r[1],l=a>=0,v=a<o.length-1;Object(c.useEffect)((function(){var e=function(){var e=b(regeneratorRuntime.mark((function e(t){var r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.data,n=r.layerDetail.canvas,a=r.index,"history"!==t.creator){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,g(n);case 5:o=e.sent,u({type:"add",payload:new f.RecordInfo("add",{index:a,canvasPath:o})});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r=function(){var e=b(regeneratorRuntime.mark((function e(t){var r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.data,n=r.layerDetail.canvas,a=r.preContent,o=r.index,"history"!==t.creator){e.next=3;break}return e.abrupt("return");case 3:return e.t0=u,e.t1=f.RecordInfo,e.t2=o,e.next=8,g(a);case 8:return e.t3=e.sent,e.next=11,g(n);case 11:e.t4=e.sent,e.t5={index:e.t2,fromCanvasPath:e.t3,toCanvasPath:e.t4},e.t6=new e.t1("modify",e.t5),e.t7={type:"add",payload:e.t6},(0,e.t0)(e.t7);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n=function(){var e=b(regeneratorRuntime.mark((function e(t){var r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.data,n=r.layerDetail.canvas,a=r.index,"history"!==t.creator){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,g(n);case 5:o=e.sent,u({type:"add",payload:new f.RecordInfo("remove",{index:a,canvasPath:o})});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return t.on("addLayer",e),t.on("contentChange",r),t.on("removeLayer",n),function(){t.off("addLayer",e),t.off("contentChange",r),t.off("removeLayer",n),_.a.remove("record")}}),[]);return i.a.createElement(c.Fragment,null,i.a.createElement("span",{className:"".concat(s.a.recordBtn," ").concat(v&&s.a.recordBtnActive||""," "),onPointerUp:v&&function(){u({type:"redo",pCanvasController:t})}||void 0},"redo"),i.a.createElement(d.Divider,null),i.a.createElement("span",{className:"".concat(s.a.recordBtn," ").concat(l&&s.a.recordBtnActive||""),onPointerUp:l&&function(){u({type:"undo",pCanvasController:t})}||void 0},"undo"))};m(R,"useReducer{[ {cursor, recorderList}, dispatchRecord ]({ cursor: -1, recorderList: []})}\nuseEffect{}"),t.default=R,(y="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(y.register(g,"saveRecordCanvas","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\record\\index.tsx"),y.register(R,"default","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\record\\index.tsx")),(h="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&h(e)}.call(this,r(3)(e))},,function(e,t,r){"use strict";r.r(t),function(e){var n,a=r(0),o=r.n(a),c=r(1),i=r(39),d=r.n(i),u=r(5);(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);var s,l,f="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},_=function(e){var t=e.pCanvasController;Object(a.useEffect)((function(){if(t){var e=function(){t.setBrushWidth(1),t.setOpacity(1)};return t.on("init",e),function(){return t.off("init",e)}}}),[]);return o.a.createElement("div",{className:d.a.asideTool},o.a.createElement(c.Divider,null),o.a.createElement(c.Slider,{defaultValue:1,vertical:!0,min:1,max:200,step:2,onChange:function(e){t&&t.setBrushWidth(e)}}),o.a.createElement(c.Divider,null),o.a.createElement(c.Slider,{vertical:!0,defaultValue:1,min:0,max:1,step:.01,onChange:function(e){t&&t.setOpacity(e)}}),o.a.createElement(c.Divider,null),o.a.createElement(u.default,{pCanvasController:t}),o.a.createElement(c.Divider,null))};f(_,"useEffect{}"),t.default=_,(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(s.register(1,"defaultWidth","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\index.tsx"),s.register(1,"defaultOpacity","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\index.tsx"),s.register(_,"default","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\index.tsx")),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&l(e)}.call(this,r(3)(e))},,,,,,,,,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__.d(__webpack_exports__,"RecordData",(function(){return RecordData})),__webpack_require__.d(__webpack_exports__,"RecordInfo",(function(){return RecordInfo})),__webpack_require__.d(__webpack_exports__,"recordListReducer",(function(){return recordListReducer}));var _workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),_util_canvas__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(56),enterModule;function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,r,n,a,o,c){try{var i=e[o](c),d=i.value}catch(e){return void r(e)}i.done?t(d):Promise.resolve(d).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function c(e){asyncGeneratorStep(o,n,a,c,i,"next",e)}function i(e){asyncGeneratorStep(o,n,a,c,i,"throw",e)}c(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},RecordData=function(){function RecordData(){_classCallCheck(this,RecordData),this.add=void 0,this.remove=void 0,this.modify=void 0}return _createClass(RecordData,[{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),RecordData}(),deleteRecordFile=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,n,a,o,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.type,n=t.data,e.t0=r,e.next="add"===e.t0?4:"modify"===e.t0?8:"remove"===e.t0?12:16;break;case 4:return n=n,e.next=7,_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.remove(n.canvasPath,{isFile:!0});case 7:return e.abrupt("break",16);case 8:return o=(a=n).fromCanvasPath,c=a.toCanvasPath,e.next=11,Promise.all([_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.remove(o,{isFile:!0}),_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.remove(c,{isFile:!0})]);case 11:return e.abrupt("break",16);case 12:return i=n.canvasPath,e.next=15,_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.remove(i,{isFile:!0});case 15:return e.abrupt("break",16);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),RecordInfo=function(){function RecordInfo(e,t){_classCallCheck(this,RecordInfo),this.type=e,this.data=t}return _createClass(RecordInfo,[{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),RecordInfo}(),getRevertRecor=function(e){var t=e.type,r=e.data;if("add"===t){var n=r,a=n.index,o=n.canvasPath;return new RecordInfo("remove",{index:a,canvasPath:o})}if("modify"===t){var c=r,i=c.index,d=c.fromCanvasPath,u=c.toCanvasPath;return new RecordInfo("modify",{index:i,fromCanvasPath:u,toCanvasPath:d})}var s=r,l=s.index,f=s.canvasPath;return new RecordInfo("add",{index:l,canvasPath:f})},handleOperate=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r){var n,a,o,c,i,d,u,s,l,f,_,p,v,b,y,h,m,g,R;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.type,a=t.data,console.log("handleOperate: ",n),"add"!==n){e.next=15;break}return c=(o=a).index,i=o.canvasPath,e.next=6,_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.get(i,{isDir:!1});case 6:return d=e.sent,u=_slicedToArray(d,1),s=u[0],e.next=11,Object(_util_canvas__WEBPACK_IMPORTED_MODULE_1__.c)(s);case 11:return l=e.sent,f=r.addLayerContent(c,l,"history"),r.focusLayer(f),e.abrupt("return");case 15:if("modify"!==n){e.next=28;break}return p=(_=a).index,_.fromCanvasPath,v=_.toCanvasPath,e.next=19,_workStorage_file_system__WEBPACK_IMPORTED_MODULE_0__.a.get(v,{isDir:!1});case 19:return b=e.sent,y=_slicedToArray(b,1),h=y[0],e.next=24,Object(_util_canvas__WEBPACK_IMPORTED_MODULE_1__.c)(h);case 24:return m=e.sent,g=r.setLayerContent(p,m,"history"),r.focusLayer(g),e.abrupt("return");case 28:if("remove"!==n){e.next=32;break}return R=a.index,r.removeLayerByIndex(R,"history"),e.abrupt("return");case 32:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),MAX_ROCORD_NUMBER=100,recordListReducer=function(e,t){var r=e.cursor,n=e.recorderList,a=t.type,o=t.payload,c=t.pCanvasController;switch(a){case"add":if(r<n.length-1)n.splice(Math.max(r,0)).map((function(e){return deleteRecordFile(e)}));if(MAX_ROCORD_NUMBER<=n.length)n.splice(0,n.length-MAX_ROCORD_NUMBER+1).map((function(e){return deleteRecordFile(e)}));r++,o&&n.push(o);break;case"redo":if(++r<=n.length-1){var i=n[r];c&&handleOperate(i,c)}break;case"undo":if(r>-1){var d=n[r];c&&handleOperate(getRevertRecor(d),c)}r--}return{cursor:Math.max(Math.min(r,n.length-1),-1),recorderList:n}},reactHotLoader,leaveModule;reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&(reactHotLoader.register(RecordData,"RecordData","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\record\\reducer.ts"),reactHotLoader.register(deleteRecordFile,"deleteRecordFile","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\record\\reducer.ts"),reactHotLoader.register(RecordInfo,"RecordInfo","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\record\\reducer.ts"),reactHotLoader.register(getRevertRecor,"getRevertRecor","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\record\\reducer.ts"),reactHotLoader.register(handleOperate,"handleOperate","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\record\\reducer.ts"),reactHotLoader.register(MAX_ROCORD_NUMBER,"MAX_ROCORD_NUMBER","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\record\\reducer.ts"),reactHotLoader.register(recordListReducer,"recordListReducer","D:\\code\\WebPencil\\src\\pages\\paint\\aside-tool-bar\\record\\reducer.ts")),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)}.call(this,__webpack_require__(3)(module))},,,,,,,,,,,function(e,t,r){e.exports={recordBtn:"recordBtn_81954",recordBtnActive:"recordBtnActive_a74d3"}},,function(e,t,r){e.exports={asideTool:"asideTool_faaa6"}},,,,,,,function(e,t,r){var n=r(47),a="object"==typeof self&&self&&self.Object===Object&&self,o=n||a||Function("return this")();e.exports=o},function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(this,r(48))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){e.exports=function(){return!1}},function(e,t){var r=Array.isArray;e.exports=r},function(e,t,r){var n=r(52),a=0;e.exports=function(e){var t=++a;return n(e)+t}},function(e,t,r){var n=r(53);e.exports=function(e){return null==e?"":n(e)}},function(e,t,r){var n=r(54),a=r(55),o=r(50),c=r(49),i=n?n.prototype:void 0,d=i?i.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return a(t,e)+"";if(c(t))return d?d.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}},function(e,t,r){var n=r(46).Symbol;e.exports=n},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}},function(e,t,r){"use strict";(function(e){r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return u})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return l}));var n,a=r(51),o=r.n(a);(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var c,i,d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=document.createElement("canvas");n.width=e,n.height=t,n.setAttribute("uuid",o()("canvasId-"));var a=n.getContext("2d");return a&&r&&(a.fillStyle=r.toRGBAString(),a.fillRect(0,0,e,t)),n},u=function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var r=t.getContext("2d");return null==r||r.clearRect(0,0,t.width,t.height),null==r||r.drawImage(e,0,0,e.width,e.height),t},s=function(e){return new Promise((function(t){var r=new Image;r.onload=function(){r.onload=null,t(u(r))},r.src=URL.createObjectURL(e)}))},l=function(e){return new Promise((function(t){e.toBlob(t,"image/png",1)}))};(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(c.register(d,"createCanvas","D:\\code\\WebPencil\\src\\util\\canvas.ts"),c.register(u,"copyCanvas","D:\\code\\WebPencil\\src\\util\\canvas.ts"),c.register(s,"createCanvasByFile","D:\\code\\WebPencil\\src\\util\\canvas.ts"),c.register(l,"toBlob","D:\\code\\WebPencil\\src\\util\\canvas.ts")),(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&i(e)}).call(this,r(3)(e))}]]);