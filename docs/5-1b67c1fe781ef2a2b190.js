(window.webpackJsonp=window.webpackJsonp||[]).push([[5,23,24,25,26],{13:function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"default",(function(){return L}));var r,n,o,c=a(0),i=a.n(c),d=a(62),l=a(41),s=a.n(l),u=a(8),_=a(14),f=a(76),v=a.n(f),p=a(55),b=a(11),m=a(7);function y(e,t,a,r,n,o,c){try{var i=e[o](c),d=i.value}catch(e){return void a(e)}i.done?t(d):Promise.resolve(d).then(r,n)}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var a=[],r=!0,n=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(a.push(c.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(n)throw o}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function L(){var e=E(Object(c.useState)(),2),t=e[0],a=e[1],r=Object(u.usePCanvas)().pCanvas;return Object(c.useEffect)((function(){var e;(e=regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.a.parse(_.b.location.search.substr(1)),r=t.workId,e.next=3,p.c.getWorkDetail(r);case 3:n=e.sent,a(n);case 5:case"end":return e.stop()}}),e)})),function(){var t=this,a=arguments;return new Promise((function(r,n){var o=e.apply(t,a);function c(e){y(o,r,n,c,i,"next",e)}function i(e){y(o,r,n,c,i,"throw",e)}c(void 0)}))})()}),[]),i.a.createElement(d.a,{contentClassName:s.a.layout,headNode:i.a.createElement(b.default,{pCanvasController:r}),asideNode:i.a.createElement(m.default,{pCanvasController:r})},t&&i.a.createElement(u.PCanvas,{pCanvasController:r,initValue:t}))}(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e),("undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e})(L,"useState{[ workDetail, setWorkDetail ]}\nusePCanvas{{pCanvas}}\nuseEffect{}",(function(){return[u.usePCanvas]})),(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&n.register(L,"Paint","/Users/muyin/Documents/code/WebPencil/src/pages/paint/index.tsx"),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&o(e)}.call(this,a(3)(e))},35:function(e,t,a){e.exports={recordBtnActive:"recordBtnActive_a74d3"}},37:function(e,t,a){e.exports={asideTool:"asideTool_faaa6"}},38:function(e,t,a){e.exports={pCanvas:"pCanvas_efb40",canvasWrap:"canvasWrap_4e8dd",unvisible:"unvisible_0b5e4",cover:"cover_edb6c"}},41:function(e,t,a){e.exports={layout:"layout_72e38"}},5:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__.d(__webpack_exports__,"RecordData",(function(){return RecordData})),__webpack_require__.d(__webpack_exports__,"RecordInfo",(function(){return RecordInfo}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),antd__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),antd__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(antd__WEBPACK_IMPORTED_MODULE_1__),_index_less__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(35),_index_less__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_index_less__WEBPACK_IMPORTED_MODULE_2__),_workStorage_canvas_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(54),enterModule;function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],r=!0,n=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(a.push(c.value),!t||a.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(n)throw o}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},RecordData=function(){function RecordData(){_classCallCheck(this,RecordData),this.add=void 0,this.remove=void 0,this.modify=void 0}return _createClass(RecordData,[{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),RecordData}(),RecordInfo=function(){function RecordInfo(e,t){_classCallCheck(this,RecordInfo),this.type=e,this.data=t}return _createClass(RecordInfo,[{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),RecordInfo}(),getRevertRecor=function(e){var t=e.type,a=e.data;if("add"===t){var r=a,n=r.index,o=r.canvas;return new RecordInfo("remove",{index:n,canvas:o})}if("modify"===t){var c=a,i=c.index,d=c.from,l=c.to;return new RecordInfo("modify",{index:i,from:l,to:d})}var s=a,u=s.index,_=s.canvas;return new RecordInfo("add",{index:u,canvas:_})},handleOperate=function(e,t){var a=e.type,r=e.data;if(console.log("handleOperate: ",a),"add"!==a)if("modify"!==a)if("remove"!==a);else{var n=r.index;t.removeLayerByIndex(n,"history")}else{var o=r,c=o.index,i=(o.from,o.to),d=t.setLayerContent(c,i,"history");t.focusLayer(d)}else{var l=r,s=l.index,u=l.canvas,_=t.addLayerContent(s,u,"history");t.focusLayer(_)}},recordListReducer=function(e,t){var a=e.cursor,r=e.recorderList,n=t.type,o=t.payload,c=t.pCanvasController;switch(n){case"add":a++>r.length-1&&r.splice(Math.max(a,0)),o&&r.push(o);break;case"redo":if(++a<=r.length-1){var i=r[a];c&&handleOperate(i,c)}break;case"undo":if(a>-1){var d=r[a];c&&handleOperate(getRevertRecor(d),c)}a--}return{cursor:Math.max(Math.min(a,r.length-1),-1),recorderList:r}},_default=function(e){var t=e.pCanvasController,a=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_0__.useReducer)(recordListReducer,{cursor:-1,recorderList:[]}),2),r=a[0],n=r.cursor,o=r.recorderList,c=a[1],i=n>=0,d=n<o.length-1;Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var e=function(e){var t=e.data,a=t.layerDetail.canvas,r=t.index;"history"!==e.creator&&c({type:"add",payload:new RecordInfo("add",{index:r,canvas:Object(_workStorage_canvas_util__WEBPACK_IMPORTED_MODULE_3__.a)(a)})})},a=function(e){var t=e.data,a=t.layerDetail.canvas,r=t.preContent,n=t.index;"history"!==e.creator&&c({type:"add",payload:new RecordInfo("modify",{index:n,from:r,to:Object(_workStorage_canvas_util__WEBPACK_IMPORTED_MODULE_3__.a)(a)})})},r=function(e){var t=e.data,a=t.layerDetail.canvas,r=t.index;"history"!==e.creator&&c({type:"add",payload:new RecordInfo("remove",{index:r,canvas:Object(_workStorage_canvas_util__WEBPACK_IMPORTED_MODULE_3__.a)(a)})})};return t.on("addLayer",e),t.on("contentChange",a),t.on("removeLayer",r),function(){t.off("addLayer",e),t.off("contentChange",a),t.off("removeLayer",r)}}),[]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{className:d&&_index_less__WEBPACK_IMPORTED_MODULE_2___default.a.recordBtnActive||"",onClick:function(){c({type:"redo",pCanvasController:t})}},"redo"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_1__.Divider,null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{className:i&&_index_less__WEBPACK_IMPORTED_MODULE_2___default.a.recordBtnActive||"",onClick:function(){c({type:"undo",pCanvasController:t})}},"undo"))},reactHotLoader,leaveModule;__signature__(_default,"useReducer{[ {cursor, recorderList}, dispatchRecord ]({ cursor: -1, recorderList: []})}\nuseEffect{}"),__webpack_exports__.default=_default,reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&(reactHotLoader.register(RecordData,"RecordData","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/index.tsx"),reactHotLoader.register(RecordInfo,"RecordInfo","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/index.tsx"),reactHotLoader.register(getRevertRecor,"getRevertRecor","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/index.tsx"),reactHotLoader.register(handleOperate,"handleOperate","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/index.tsx"),reactHotLoader.register(recordListReducer,"recordListReducer","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/index.tsx"),reactHotLoader.register(_default,"default","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/record/index.tsx")),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)}.call(this,__webpack_require__(3)(module))},62:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return v}));var r,n=a(0),o=a.n(n),c=a(63),i=a.n(c),d=a(14),l=a(1),s=a(88);function u(e,t,a,r,n,o,c){try{var i=e[o](c),d=i.value}catch(e){return void a(e)}i.done?t(d):Promise.resolve(d).then(r,n)}(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);var _,f;"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;function v(e){var t=e.className,a=void 0===t?"":t,r=e.headNode,n=void 0===r?null:r,c=e.asideClass,_=void 0===c?"":c,f=e.asideNode,v=void 0===f?null:f,p=e.children,b=void 0===p?null:p,m=e.beforeBack,y=e.showBackButton,E=void 0===y||y,L=e.contentClassName,C=void 0===L?"":L,h=function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t1=m,!e.t1){e.next=5;break}return e.next=4,m();case 4:e.t1=e.sent;case 5:if(e.t0=e.t1,e.t0){e.next=8;break}e.t0=!m;case 8:if(!e.t0){e.next=10;break}d.b.goBack();case 10:case"end":return e.stop()}}),e)})),function(){var t=this,a=arguments;return new Promise((function(r,n){var o=e.apply(t,a);function c(e){u(o,r,n,c,i,"next",e)}function i(e){u(o,r,n,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}();return o.a.createElement("section",{className:"".concat(i.a.section," ").concat(a)},o.a.createElement("header",null,E&&o.a.createElement(l.Button,{ghost:!0,onClick:h,shape:"circle",size:"small",icon:o.a.createElement(s.a,null)}),!1,n),o.a.createElement("div",{className:i.a.wrapper},o.a.createElement("aside",{className:_},v),o.a.createElement("main",{className:C},b)))}(_="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&_.register(v,"Home","/Users/muyin/Documents/code/WebPencil/src/lauout/BasicLayout.tsx"),(f="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&f(e)}).call(this,a(3)(e))},63:function(e,t,a){e.exports={section:"section_c21f7",wrapper:"wrapper_e44d8"}},7:function(e,t,a){"use strict";a.r(t),function(e){var r,n=a(0),o=a.n(n),c=a(1),i=a(37),d=a.n(i),l=a(5);(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);var s,u,_="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},f=function(e){var t=e.pCanvasController;Object(n.useEffect)((function(){if(t){var e=function(){t.setBrushWidth(1),t.setOpacity(1)};return t.on("init",e),function(){return t.off("init",e)}}}),[]);return o.a.createElement("div",{className:d.a.asideTool},o.a.createElement(c.Divider,null),o.a.createElement(c.Slider,{defaultValue:1,vertical:!0,min:1,max:200,step:2,onChange:function(e){t&&t.setBrushWidth(e)}}),o.a.createElement(c.Divider,null),o.a.createElement(c.Slider,{vertical:!0,defaultValue:1,min:0,max:1,step:.01,onChange:function(e){t&&t.setOpacity(e)}}),o.a.createElement(c.Divider,null),o.a.createElement(l.default,{pCanvasController:t}),o.a.createElement(c.Divider,null))};_(f,"useEffect{}"),t.default=f,(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(s.register(1,"defaultWidth","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/index.tsx"),s.register(1,"defaultOpacity","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/index.tsx"),s.register(f,"default","/Users/muyin/Documents/code/WebPencil/src/pages/paint/aside-tool-bar/index.tsx")),(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&u(e)}.call(this,a(3)(e))},8:function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"PCanvas",(function(){return f})),a.d(t,"usePCanvas",(function(){return s}));var r,n=a(0),o=a.n(n),c=a(38),i=a.n(c),d=a(23);a.d(t,"PCanvasController",(function(){return d.PCanvasController})),a.d(t,"CanvasEventData",(function(){return d.CanvasEventData})),a.d(t,"CanvasEvent",(function(){return d.CanvasEvent})),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);var l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},s=function(){return{pCanvas:Object(n.useRef)(new d.PCanvasController).current}};l(s,"useRef{{current: pCanvas}}");var u,_,f=function(e){var t=e.initValue,a=e.pCanvasController,r=Object(n.useRef)(null),c=Object(n.useRef)(null);return Object(n.useEffect)((function(){if(a&&c.current&&r.current){var e={wrap:c.current,cover:r.current};a.init(e,t)}}),[]),Object(n.useEffect)((function(){var e=r.current;if(e){var t=function(e){a&&a.onPointerDown(e)},n=function(e){a&&a.onPointerMove(e)},o=function(e){a&&a.onPointerUp(e)};return e.addEventListener("pointerdown",t,{passive:!1}),e.addEventListener("pointermove",n,{passive:!1}),e.addEventListener("pointerup",o,{passive:!1}),console.log("add...."),function(){e.removeEventListener("pointerdown",t),e.removeEventListener("pointermove",n),e.removeEventListener("pointerup",o)}}}),[r.current]),o.a.createElement("main",{className:i.a.pCanvas},o.a.createElement("section",{ref:c,className:i.a.canvasWrap},o.a.createElement("div",{ref:r,className:i.a.cover})))};l(f,"useRef{coverRef}\nuseRef{wrapRef}\nuseEffect{}\nuseEffect{}"),(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(u.register(s,"usePCanvas","/Users/muyin/Documents/code/WebPencil/src/pages/paint/pcanvas/index.tsx"),u.register(f,"PCanvas","/Users/muyin/Documents/code/WebPencil/src/pages/paint/pcanvas/index.tsx")),(_="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&_(e)}.call(this,a(3)(e))}}]);