(window.webpackJsonp=window.webpackJsonp||[]).push([[3,6,14,17,26],[,,,,,,,,,function(e,t,r){"use strict";r.r(t),function(e){var n,a=r(0),o=r.n(a),i=r(1),c=r(51),u=r(36),l=r.n(u),s=r(62);function _(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);var f,y,p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},v=function(e){var t=e.pCanvasController,r=d(Object(a.useState)([]),2),n=r[0],u=r[1],f=Object(a.useRef)({}),y=Object(a.useRef)([]),p=Object(s.a)(n,y,f).copyCanvas,v=d(Object(a.useState)(""),2),h=v[0],b=v[1],g=d(Object(a.useState)(!1),2),L=g[0],k=g[1],w=function(){k((function(e){return e||setTimeout(p),!e}))};Object(a.useEffect)((function(){var e=function(){for(var e=t.getLayers(),r=[],n=e.length-1;n>=0;n--){var a,o=e[n];if(o.type===c.b.NORMAL&&(r.push(o),y.current.push(o)),o.type===c.b.TEMP_COVER)b(null===(a=e[n+1])||void 0===a?void 0:a.layerId)}u((function(e){return[].concat(_(e),r)}))};return t.on("init",e),function(){return t.off("init",e)}}),[]),Object(a.useEffect)((function(){var e=function(e){console.log("onFocusLayer..."),b(e.layerId)},r=function(e){console.log("onAddLayer"),e.type===c.b.NORMAL&&(y.current.push(e),u((function(t){return[e].concat(_(t))})))},n=function(e){u((function(t){var r=t.indexOf(e);return r>-1&&t.splice(r,1),_(t)}))},a=function(e){e&&y.current.push(e)};return t.on("addLayer",r),t.on("contentChange",a),t.on("focusLayer",e),t.on("removeLayer",n),function(){t.off("contentChange",a),t.off("addLayer",r),t.off("focusLayer",e),t.off("removeLayer",n)}}),[]);return o.a.createElement("div",null,o.a.createElement(i.Tag,{onClick:w},"111"),o.a.createElement(i.Drawer,{title:null,width:200,visible:L,onClose:w},o.a.createElement(i.List,{header:o.a.createElement("span",{onClick:function(){t.addLayer()}},"+"),className:l.a.pannelWrap,itemLayout:"horizontal",dataSource:n,rowKey:"layerId",renderItem:function(e,r){var a=e.visible,c=e.layerId;e.name;return o.a.createElement(i.List.Item,{className:c===h?l.a.active:""},o.a.createElement(i.List.Item.Meta,{avatar:o.a.createElement("canvas",{onClick:function(){return r=e,void t.focusLayer(r);var r},key:c,id:c,ref:function(e){f.current[c]=e},className:l.a.canvases,width:"45",height:"45"}),title:o.a.createElement("span",null,"layer ".concat(n.length-r)),description:o.a.createElement("div",null,o.a.createElement("span",null,a?"visible":"unvisible"),o.a.createElement("span",{onClick:function(){return r=e,void t.removeLayer(r);var r}},"remove"))}))}})))};p(v,"useState{[layers, setLayers]([])}\nuseRef{canvasesRef}\nuseRef{needUpdateRef}\nuseCopyLayer{{ copyCanvas }}\nuseState{[ activeLayerId, setActiveLayerId ]('')}\nuseState{[ showLayerDraw, setShowLayerDraw ](false)}\nuseEffect{}\nuseEffect{}",(function(){return[s.a]})),t.default=v,(f="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&f.register(v,"default","D:\\code\\WebPencil\\src\\pages\\paint\\top-tool-bar\\tool-item\\layer-pannel\\index.tsx"),(y="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&y(e)}.call(this,r(3)(e))},,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var enterModule;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}__webpack_require__.d(__webpack_exports__,"RGBA",(function(){return RGBA})),enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},RGBA=function(){function RGBA(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;_classCallCheck(this,RGBA),this.r=e,this.g=t,this.b=r,this.a=n}return _createClass(RGBA,null,[{key:"Lerp",value:function(e,t,r){for(var n=[],a=(t.r-e.r)/r,o=(t.g-e.g)/r,i=(t.b-e.b)/r,c=(t.a-e.a)/r,u=0;u<r;u++)n.push(new RGBA(e.r+a*u,e.g+o*u,e.b+i*u,e.a+c*u));return n}},{key:"mutipy",value:function(e,t){return new RGBA(e.r*t,e.g*t,e.b*t)}},{key:"add",value:function(e,t){var r=e.r,n=e.g,a=e.b;return new RGBA(r+t.r,n+t.g,a+t.b)}},{key:"mix",value:function(e,t,r){return new RGBA(e.r+(t.r-e.r)*r,e.g+(t.g-e.g)*r,e.b+(t.b-e.b)*r)}},{key:"getLerpColor",value:function(e,t,r){var n=e.r,a=e.g,o=e.b,i=e.a;return new RGBA((t.r-n)*r+n,(t.g-a)*r+a,(t.b-o)*r+o,(t.a-i)*r+i)}}]),_createClass(RGBA,[{key:"toRGBAString",value:function(){return"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.a,")")}},{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),RGBA}(),reactHotLoader,leaveModule;RGBA.BLACK=new RGBA(0,0,0),RGBA.WHITE=new RGBA(255,255,255),reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&reactHotLoader.register(RGBA,"RGBA","D:\\code\\WebPencil\\src\\pages\\paint\\top-tool-bar\\tool-item\\color-selector\\rgba.ts"),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)}.call(this,__webpack_require__(3)(module))},,,,,,,,,,,,,,,function(e,t,r){e.exports={layerPannel:"layerPannel_e799a",pannelWrap:"pannelWrap_b4fbf",canvases:"canvases_b0d45",active:"active_1674e"}},,,,,function(e,t,r){var n=r(43),a="object"==typeof self&&self&&self.Object===Object&&self,o=n||a||Function("return this")();e.exports=o},function(e,t,r){var n=r(46),a=0;e.exports=function(e){var t=++a;return n(e)+t}},function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(this,r(44))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){var r=Array.isArray;e.exports=r},function(e,t,r){var n=r(47);e.exports=function(e){return null==e?"":n(e)}},function(e,t,r){var n=r(48),a=r(49),o=r(45),i=r(50),c=n?n.prototype:void 0,u=c?c.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return a(t,e)+"";if(i(t))return u?u.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}},function(e,t,r){var n=r(41).Symbol;e.exports=n},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}},function(e,t){e.exports=function(){return!1}},function(module,__webpack_exports__,__webpack_require__){"use strict";(function(module){__webpack_require__.d(__webpack_exports__,"c",(function(){return WorkDetail})),__webpack_require__.d(__webpack_exports__,"b",(function(){return LayerDetailType})),__webpack_require__.d(__webpack_exports__,"a",(function(){return LayerDetail})),__webpack_require__.d(__webpack_exports__,"d",(function(){return WorkStorage}));var lodash_uniqueId__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(42),lodash_uniqueId__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_uniqueId__WEBPACK_IMPORTED_MODULE_0__),_pages_paint_top_tool_bar_tool_item_color_selector_rgba__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21),_canvas_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(52),enterModule;function asyncGeneratorStep(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){asyncGeneratorStep(o,n,a,i,c,"next",e)}function c(e){asyncGeneratorStep(o,n,a,i,c,"throw",e)}i(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}enterModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0,enterModule&&enterModule(module);var __signature__="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},WorkInfo=function(){function WorkInfo(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Date.now(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Date.now(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:lodash_uniqueId__WEBPACK_IMPORTED_MODULE_0___default()("work_".concat(Date.now(),"_"));_classCallCheck(this,WorkInfo),this.width=e,this.height=t,this.name=r,this.thumbnail=n,this.createTime=a,this.updateTime=o,this.workId=i}return _createClass(WorkInfo,[{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),WorkInfo}(),WorkDetail=function(){function WorkDetail(e,t){_classCallCheck(this,WorkDetail),this.workInfo=e,this.contens=t}return _createClass(WorkDetail,[{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}],[{key:"createEmpty",value:function(e,t,r){var n=new WorkInfo(e,t,"new work",Object(_canvas_util__WEBPACK_IMPORTED_MODULE_2__.a)(e,t,r)),a=new WorkLayers;return WorkLayers.addLayer(a,n,LayerDetail.create(n,_pages_paint_top_tool_bar_tool_item_color_selector_rgba__WEBPACK_IMPORTED_MODULE_1__.RGBA.WHITE)),WorkLayers.addLayer(a,n,LayerDetail.create(n,void 0,LayerDetailType.TEMP_COVER)),new WorkDetail(n,a)}}]),WorkDetail}(),LayerDetailType;!function(e){e[e.TEMP_COVER=1]="TEMP_COVER",e[e.NORMAL=2]="NORMAL"}(LayerDetailType||(LayerDetailType={}));var LayerDetail=function(){function LayerDetail(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:LayerDetailType.NORMAL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"new layer",n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:lodash_uniqueId__WEBPACK_IMPORTED_MODULE_0___default()("layer-".concat(Date.now(),"-"));_classCallCheck(this,LayerDetail),this.canvas=e,this.type=t,this.name=r,this.visible=n,this.layerId=a}return _createClass(LayerDetail,[{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}],[{key:"create",value:function(e,t,r){var n=e.width,a=e.height,o=Object(_canvas_util__WEBPACK_IMPORTED_MODULE_2__.a)(n,a,t),i=new LayerDetail(o,r);return o.setAttribute("layerId",i.layerId),i}}]),LayerDetail}(),WorkLayers=function(){function WorkLayers(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lodash_uniqueId__WEBPACK_IMPORTED_MODULE_0___default()("worklayer-".concat(Date.now(),"-"));_classCallCheck(this,WorkLayers),this.workLayersId=e,this.layers=[]}return _createClass(WorkLayers,[{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}],[{key:"addLayer",value:function(e,t,r){var n=t.width,a=t.height;r||(r=new LayerDetail(Object(_canvas_util__WEBPACK_IMPORTED_MODULE_2__.a)(n,a))),e.layers.unshift(r)}}]),WorkLayers}(),WorkStorage=function(){function e(){_classCallCheck(this,e)}var t,r,n,a,o,i;return _createClass(e,null,[{key:"addWork",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"removeWork",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"updateWorkInfo",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"batchUpdateLayerDetail",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"getWorkDetail",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",WorkDetail.createEmpty(screen.width,screen.height,_pages_paint_top_tool_bar_tool_item_color_selector_rgba__WEBPACK_IMPORTED_MODULE_1__.RGBA.WHITE));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"getWorkList",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}(),reactHotLoader,leaveModule;reactHotLoader="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0,reactHotLoader&&(reactHotLoader.register(WorkInfo,"WorkInfo","D:\\code\\WebPencil\\src\\workStorage\\index.ts"),reactHotLoader.register(WorkDetail,"WorkDetail","D:\\code\\WebPencil\\src\\workStorage\\index.ts"),reactHotLoader.register(LayerDetail,"LayerDetail","D:\\code\\WebPencil\\src\\workStorage\\index.ts"),reactHotLoader.register(WorkLayers,"WorkLayers","D:\\code\\WebPencil\\src\\workStorage\\index.ts"),reactHotLoader.register(WorkStorage,"WorkStorage","D:\\code\\WebPencil\\src\\workStorage\\index.ts")),leaveModule="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0,leaveModule&&leaveModule(module)}).call(this,__webpack_require__(3)(module))},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return u}));var n,a=r(42),o=r.n(a);(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var i,c,u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=document.createElement("canvas");n.width=e,n.height=t,n.setAttribute("uuid",o()("canvasId-"));var a=n.getContext("2d");return a&&r&&(a.fillStyle=r.toRGBAString(),a.fillRect(0,0,e,t)),n};(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&i.register(u,"createCanvas","D:\\code\\WebPencil\\src\\workStorage\\canvas.util.ts"),(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&c(e)}).call(this,r(3)(e))},,,,,,function(e,t){e.exports=function(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}},,,,function(e,t,r){"use strict";(function(e){var n,a=r(63),o=r.n(a),i=r(0);function c(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);var u,l,s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},_=function(e,t){var r=t.getContext("2d");r&&(r.clearRect(0,0,t.width,t.height),r.drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height))},d=function(e,t){var r=o()(e.current,(function(e){return e.layerId})),n=t.current;c(r).forEach((function(t){var r=n[t.layerId];if(r){console.log("map..",t.layerId),_(t.canvas,r);var a=e.current.findIndex((function(e){return e.layerId===t.layerId}));e.current.splice(a,1)}}))},f=function(e,t,r){var n=function(){return d(t,r)};return Object(i.useEffect)(n,[e]),{copyCanvas:n}};s(f,"useEffect{}"),t.a=f,(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(u.register(_,"mapCanvas","D:\\code\\WebPencil\\src\\hooks\\use-copy-layer.ts"),u.register(d,"copCanvas","D:\\code\\WebPencil\\src\\hooks\\use-copy-layer.ts"),u.register(f,"default","D:\\code\\WebPencil\\src\\hooks\\use-copy-layer.ts")),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&l(e)}).call(this,r(3)(e))},function(e,t,r){var n=r(64),a=r(65);e.exports=function(e,t){return e&&e.length?a(e,n(t,2)):[]}},function(e,t){e.exports=function(e){return e}},function(e,t,r){var n=r(66),a=r(67),o=r(68),i=r(69),c=r(70),u=r(71);e.exports=function(e,t,r){var l=-1,s=a,_=e.length,d=!0,f=[],y=f;if(r)d=!1,s=o;else if(_>=200){var p=t?null:c(e);if(p)return u(p);d=!1,s=i,y=new n}else y=t?[]:f;e:for(;++l<_;){var v=e[l],h=t?t(v):v;if(v=r||0!==v?v:0,d&&h==h){for(var b=y.length;b--;)if(y[b]===h)continue e;t&&y.push(h),f.push(v)}else s(y,h,r)||(y!==f&&y.push(h),f.push(v))}return f}},function(e,t,r){var n=r(45);e.exports=function(){if(!arguments.length)return[];var e=arguments[0];return n(e)?e:[e]}},function(e,t,r){var n=r(58);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},function(e,t){e.exports=function(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}},function(e,t,r){var n=r(58);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(){return[]}}]]);